function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");let o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}const products=[{upc:"Steakumm",img:"/wp-content/uploads/2020/05/sliced-steak-300x206.png",title:"100% Beef Sandwich Steaks"},{upc:"7254507001",img:"/wp-content/uploads/2020/05/chicken-steak-300x204.png",title:"Chicken Breast Sandwich Steaks"},{upc:"7254506270",img:"/wp-content/uploads/2020/05/angus-steak-300x204.png",title:"100% Angus Beef Sandwich Steaks"}];function loadMap(e,t,o){document.getElementById("map").classList.remove("hidden");const n=`customer=quaker&item=${e}&zip=${t}&radius=${o}&count=10`,r=new XMLHttpRequest;r.open("POST","/wp-content/themes/steak-umm/storefinder/",!0),r.responseType="json",r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send(n),r.onload=(()=>{let e=r.response;if(e.numStoresFound>0){const t=new google.maps.Map(document.getElementById("map")),o=new google.maps.LatLngBounds,n=e.nearbyStores;let r="";const a=[],c=[];n.forEach(e=>{let n=new google.maps.Marker({position:{lat:e.latitude,lng:e.longitude},map:t});c.push(n);const s=new google.maps.InfoWindow({content:"<p><strong>"+e.name+"</strong><br>"+e.address+"<br>"+e.city+", "+e.state+" "+e.zip+"<br>"+e.phone+"<br>"+e.distance+" Miles<br><a target='_blank' href='https://maps.google.com?saddr=Current+Location&daddr="+e.latitude+","+e.longitude+"'>Get Directions</a></td></tr>"});a.push(s),n.addListener("click",function(){for(let e=0;a[e];e++)a[e].close();s.open(t,n)});let d="<tr><td><strong>"+e.name+"</strong><br>";d+=e.address+"<br>",d+=e.city+", "+e.state+" "+e.zip+"<br>",d+=e.phone+"<br></td>",d+="<td>"+e.distance+" MILES<br>",d+="<a target='_blank' href='https://maps.google.com?saddr=Current+Location&daddr="+e.latitude+","+e.longitude+"'>Get Directions</a></td></tr>",r+=d,o.extend(n.position)}),t.fitBounds(o),t.setZoom(13);let s="";for(let t=0;t<products.length;t++)e.item===products[t].upc&&(s=`<img src="${products[t].img}" alt="${products[t].title}">`,t=products.length);const d=`<tr><th id='product-thumb'>${s}</th><th>LOCATIONS NEAR YOU</th></tr><tr class="subheader"><td>STORES</td><td>DISTANCE</td></tr>`;document.querySelector(".store-list > table > tbody").innerHTML=d+r}else document.querySelector(".store-list > table > tbody").innerHTML="<tr><td><strong>Sorry, no results were found!</strong></td></tr>"})}document.addEventListener("DOMContentLoaded",()=>{document.querySelector("form.locator-form").addEventListener("submit",e=>{e.preventDefault();const t=new FormData(e.target);loadMap(t.get("upc"),t.get("zip"),t.get("distance"))});const e=getParameterByName("upc"),t=getParameterByName("zip"),o=getParameterByName("distance");if(t)document.querySelectorAll(".locator-form .upc").forEach(t=>{t.value=e}),document.querySelectorAll(".locator-form .zipcode").forEach(e=>{e.value=t}),document.querySelectorAll(".locator-form .distance").forEach(e=>{e.value=o}),loadMap(e,t,o);else if(navigator.geolocation){const e=new google.maps.Geocoder,t={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};navigator.geolocation.getCurrentPosition(function(t){const o={lat:t.coords.latitude,lng:t.coords.longitude};e.geocode({location:o},function(e,t){"OK"===t?e[0]?(document.querySelector("#zipcode-field").value=e[0].address_components[6].long_name,document.querySelector('#product-search > button[type="submit"]').click()):console.warn("No geocode results found"):console.warn("Geocoder failed due to: "+t)})},function(e){console.warn(e.message)},t)}});